from Crypto.Cipher import AES

import base64,uuid,sys
import binascii
import hashlib

#key="kPH+bIxk5D2deZiIxcaaaA=="
key='zSyK5Kp6PZAAjlT+eeNMlg=='
de="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"
key='4AvVhmFLUs0KTA3Kprsdag=='
de="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"
checker="rO0ABXNyADJvcmcuYXBhY2hlLnNoaXJvLnN1YmplY3QuU2ltcGxlUHJpbmNpcGFsQ29sbGVjdGlvbqh/WCXGowhKAwABTAAPcmVhbG1QcmluY2lwYWxzdAAPTGphdmEvdXRpbC9NYXA7eHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHIAEWphdmEudXRpbC5IYXNoTWFwBQfawcMWYNEDAAJGAApsb2FkRmFjdG9ySQAJdGhyZXNob2xkeHA/QAAAAAAADHcIAAAAEAAAAAF0AC5jb20uamVlY21zLmNvcmUuc2VjdXJpdHkuQ21zQXV0aG9yaXppbmdSZWFsbV8wc3IAF2phdmEudXRpbC5MaW5rZWRIYXNoU2V02GzXWpXdKh4CAAB4cgARamF2YS51dGlsLkhhc2hTZXS6RIWVlri3NAMAAHhwdwwAAAAQP0AAAAAAAAF0AAVhZG1pbnh4AHcBAXEAfgAFeA=="
checkerjava="rO0ABXNyADJvcmcuYXBhY2hlLnNoaXJvLnN1YmplY3QuU2ltcGxlUHJpbmNpcGFsQ29sbGVjdGlvbqh/WCXGowhKAwABTAAPcmVhbG1QcmluY2lwYWxzdAAPTGphdmEvdXRpbC9NYXA7eHBzcgAXamF2YS51dGlsLkxpbmtlZEhhc2hNYXA0wE5cEGzA+wIAAVoAC2FjY2Vzc09yZGVyeHIAEWphdmEudXRpbC5IYXNoTWFwBQfawcMWYNEDAAJGAApsb2FkRmFjdG9ySQAJdGhyZXNob2xkeHA/QAAAAAAADHcIAAAAEAAAAAF0AAhpbmlSZWFsbXNyABdqYXZhLnV0aWwuTGlua2VkSGFzaFNldNhs11qV3SoeAgAAeHIAEWphdmEudXRpbC5IYXNoU2V0ukSFlZa4tzQDAAB4cHcMAAAAED9AAAAAAAABdAAFYWRtaW54eAB3AQFxAH4ABXg="
de2="Y5j/skXpD2ABvTtyGc0OdCaUZbFCC+qWgyl96yso9xnPbbO6vs2UHoXMQWTovL6FHGgAgBQJvBb2+aOA/dmNp17U+KbXYQajDX9invl5USQq9frsbG9AmZYasltS8tqBSc7wH6TXBS+2exuzWx+/U56xGwAmtkThO9HDWTvQtR35aygg0JOA+vkGzS/PIhAAEfLI4kumPHncLl6WPuQeSN7HQbBtYJpzzxjz6jjiQchbNARJ+2aV8Mt1PGXD6+2f3nub/LTdRpC7R5pqnoxIWzpGuagL5m+6eppMyHNkkuuGJMkiVvYKtXToM+HXisYywyziO8wBfL32RCEFonE+loEJi1GPczPW5daJUB4Zcp2HIMbYZTkpRkcT8iJRjJUYcCjSjl3f118zQAtNHZpsuy18B/n9dY41NRduJKHeh2On2jQWSw2JU1douSr9yDC+W6u71RRzDWOSK6A1n6gOaQgmJrWZscJOhiVKoRNjLMRBQSsrcM1jMghpOXF4Zt52Ug=="
checker2 = "rO0ABXNyADJvcmcuYXBhY2hlLnNoaXJvLnN1YmplY3QuU2ltcGxlUHJpbmNpcGFsQ29sbGVjdGlvbqh/WCXGowhKAwABTAAPcmVhbG1QcmluY2lwYWxzdAAPTGphdmEvdXRpbC9NYXA7eHBwdwEAeA=="


def cmd5(src):
    m = hashlib.md5()
    m.update(src)
    return m.hexdigest()

def gcm_decode(s):
    global key
    BS   = AES.block_size
    mode =  AES.MODE_GCM
    cipher=base64.b64decode(s)
    iv=cipher[0:16]
    enc=cipher[16:-16]
    tag=cipher[-16:]
    decryptor = AES.new(base64.b64decode(key), mode, iv)
    plaintext=decryptor.decrypt_and_verify(enc,tag)
    print("decode_plaintext:")
    print(plaintext)
    base64_plaintext=base64.b64encode(plaintext).decode()
    print ("\nbase64_plaintext:\n"+base64_plaintext+"\n")
    return base64_plaintext

def gcm_encode(p):
    global key
    BS   = AES.block_size
    mode =  AES.MODE_GCM
    iv   =  uuid.uuid4().bytes
    encryptor = AES.new(base64.b64decode(key), mode, iv)
    file_body=base64.b64decode(p)
    enc,tag=encryptor.encrypt_and_digest(file_body)
    base64_ciphertext = base64.b64encode(iv + enc+tag)
    print("Encode_result:")
    print(base64_ciphertext)
    print("\n")
    return base64_ciphertext

def cbc_encode(p):
    global key
    BS   = AES.block_size
    pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()
    print (pad(b"\x01\x01\x01"))
    mode =  AES.MODE_CBC
    iv   =  uuid.uuid4().bytes
    encryptor = AES.new(base64.b64decode(key), mode, iv)
    file_body=pad(base64.b64decode(p))
    print (base64.b64decode(p))
    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body)) 
    print (base64_ciphertext)

def cbc_decode(s):
    global key
    BS   = AES.block_size
    unpad = lambda s : s[0:-(s[-1])]
    mode =  AES.MODE_CBC
    cipher=base64.b64decode(s)
    iv=cipher[0:16]
    enc=cipher[16:]
    encryptor = AES.new(base64.b64decode(key), mode, iv)
    plaintext=encryptor.decrypt(enc)
    print (base64.b64encode(unpad(plaintext)).decode())

if __name__ =='__main__':
      

