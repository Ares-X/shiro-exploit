from Crypto.Cipher import AES
import base64,uuid,sys
import binascii
import hashlib

#key="kPH+bIxk5D2deZiIxcaaaA=="
key='zSyK5Kp6PZAAjlT+eeNMlg=='
de="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"
def cmd5(src):
    m = hashlib.md5()
    m.update(src)
    return m.hexdigest()

def encode(p):
    global key
    BS   = AES.block_size
    pad = lambda s: s + ((BS - len(s) % BS) * chr(BS - len(s) % BS)).encode()
    print (pad(b"\x01\x01\x01"))
    mode =  AES.MODE_CBC
    iv   =  uuid.uuid4().bytes
    encryptor = AES.new(base64.b64decode(key), mode, iv)
    file_body=pad(base64.b64decode(p))
    print (base64.b64decode(p))
    base64_ciphertext = base64.b64encode(iv + encryptor.encrypt(file_body)) 
    print (base64_ciphertext)

def decode(s):
    global key
    BS   = AES.block_size
    unpad = lambda s : s[0:-(s[-1])]
    mode =  AES.MODE_CBC
    cipher=base64.b64decode(s)
    print (len(cipher))
    iv=cipher[0:16]
    enc=cipher[16:]
    encryptor = AES.new(base64.b64decode(key), mode, iv)
    plaintext=encryptor.decrypt(enc)
    print(plaintext)
    print ("\n\n\n")
    print (base64.b64encode(unpad(plaintext)).decode())
    print ("\n")

decode(de)

